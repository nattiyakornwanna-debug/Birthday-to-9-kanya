<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Happy Birthday üéÇ</title>
  <meta name="description" content="‡πÄ‡∏ß‡πá‡∏ö‡∏≠‡∏ß‡∏¢‡∏û‡∏£‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏™‡∏∏‡∏î‡∏Ñ‡∏¥‡πâ‡∏ß‡∏ó‡πå ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ü‡πá‡∏ï‡∏ï‡∏¥ ‡∏ö‡∏≠‡∏•‡∏•‡∏π‡∏ô ‡πÄ‡∏û‡∏•‡∏á ‡πÅ‡∏•‡∏∞‡∏™‡πÑ‡∏•‡∏î‡πå‡∏£‡∏π‡∏õ" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Itim&family=Kanit:wght@300;400;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#fff8fb;
      --ink:#2b2b2b;
      --pink:#ff6fb5;
      --lav:#a18aff;
      --mint:#84e1d8;
      --gold:#ffcc66;
      --card:#ffffffcc;
      --blur: 10px;
      --radius: 18px;
      --shadow: 0 20px 50px rgba(0,0,0,.12);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:linear-gradient(160deg,var(--bg),#f7f0ff 40%,#e6fff8 100%);
      color:var(--ink); font-family:'Kanit',system-ui,Segoe UI,sans-serif;
      overflow-x:hidden;
    }
    /* Floating decorations (hearts & balloons) */
    .floaty{position:fixed; inset:0; pointer-events:none; z-index:0}
    .balloon{
      position:absolute; bottom:-15vh; width:40px; height:55px; border-radius:50% 50% 50% 50% / 60% 60% 40% 40%;
      box-shadow: inset -4px -8px 18px rgba(0,0,0,.08);
      animation: rise linear both; filter:saturate(1.1);
    }
    .balloon:after{
      content:""; position:absolute; bottom:-18px; left:50%; width:2px; height:28vh; background:rgba(0,0,0,.15); transform:translateX(-50%);
    }
    @keyframes rise{
      from{transform:translateY(0) translateX(0) rotate(0); opacity:.0}
      to{transform:translateY(-120vh) translateX(var(--drift)) rotate(6deg); opacity:.9}
    }
    /* Container */
    .wrap{position:relative; z-index:1; min-height:100%; display:flex; flex-direction:column; align-items:center}
    header{
      width:min(920px,92vw); margin:24px auto 0; padding:16px 20px;
      backdrop-filter: blur(var(--blur)); -webkit-backdrop-filter: blur(var(--blur));
      background:var(--card); border:1px solid rgba(255,255,255,.7); border-radius:999px;
      display:flex; align-items:center; gap:12px; box-shadow:var(--shadow)
    }
    header .dot{width:10px; height:10px; border-radius:50%}
    header .title{font-family:'Itim',cursive; font-size:20px}
    /* Hero card */
    .card{
      width:min(920px,92vw); margin:20px auto; padding:24px;
      background:var(--card); border:1px solid rgba(255,255,255,.7);
      border-radius:var(--radius); box-shadow:var(--shadow);
      display:grid; gap:18px;
    }
    .hero{
      display:grid; grid-template-columns:1.2fr 1fr; gap:18px;
    }
    @media (max-width:820px){ .hero{grid-template-columns:1fr} }
    .glass{
      position:relative; overflow:hidden;
      border-radius:var(--radius); background:rgba(255,255,255,.7);
      border:1px solid rgba(255,255,255,.7);
    }
    .heroL{padding:28px}
    .tag{
      display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:999px;
      background:#fff; border:1px solid #f1e9ff; font-size:14px
    }
    .hbd{font-family:'Itim',cursive; font-size:46px; line-height:1.1; margin:10px 0 6px}
    .typed{font-size:18px; opacity:.9; min-height:2.4em; white-space:pre-wrap}
    .meta{display:flex; gap:10px; flex-wrap:wrap; margin-top:8px}
    .meta span{background:#fff; border:1px dashed #eee; padding:6px 10px; border-radius:999px; font-size:14px}
    .ctaRow{display:flex; gap:10px; flex-wrap:wrap; margin-top:12px}
    button, .btn{
      appearance:none; border:none; border-radius:12px; padding:12px 16px;
      box-shadow:inset 0 -2px 0 rgba(0,0,0,.06), 0 8px 18px rgba(0,0,0,.08);
      background:linear-gradient(180deg,#fff,#f4edff); cursor:pointer; font-weight:700;
    }
    .btnAccent{background:linear-gradient(180deg,var(--pink),#ff89c7); color:#fff}
    .btnGhost{background:#fff; border:1px solid #eee}
    .heroR{
      display:grid; place-items:center; padding:10px; background:conic-gradient(from 180deg at 50% 50%, #fff 0 25%, #fff5 0 50%, #fff 0 75%, #fff5 0 100%);
    }
    .pola{
      width:100%; max-width:320px; aspect-ratio:3/4; background:#fff; border-radius:16px; padding:10px; border:1px solid #eee;
      display:grid; grid-template-rows:1fr auto; gap:8px; transform:rotate(-2.2deg);
      box-shadow:0 30px 80px rgba(0,0,0,.12)
    }
    .pola img{width:100%; height:100%; object-fit:cover; border-radius:10px}
    .pola small{display:block; text-align:center; font-family:'Itim',cursive}
    /* Countdown */
    .countdown{
      display:flex; gap:12px; flex-wrap:wrap; justify-content:center; padding:12px
    }
    .dd{
      min-width:92px; padding:14px 10px; background:#fff; border:1px solid #eee; border-radius:14px; text-align:center
    }
    .dd b{font-size:28px; display:block}
    .dd span{font-size:12px; opacity:.7}
    /* Gallery slider */
    .slider{position:relative; border-radius:16px; overflow:hidden; background:#000}
    .slides{display:flex; transition:transform .6s ease}
    .slides img{width:100%; aspect-ratio:16/9; object-fit:cover}
    .dots{position:absolute; inset:auto 0 10px 0; display:flex; justify-content:center; gap:6px}
    .dots button{width:10px; height:10px; border-radius:50%; opacity:.6}
    .dots button.active{opacity:1; transform:scale(1.2)}
    /* Wish box */
    .wish{
      padding:18px; border-radius:16px; background:linear-gradient(180deg,#fff,#f8fff9);
      border:1px solid #e8f4ec; display:grid; gap:10px
    }
    .wish p{margin:0; font-size:16px}
    .note{
      font-size:13px; opacity:.6; text-align:center
    }
    /* Footer */
    footer{margin:40px 0 24px; opacity:.7; text-align:center; font-size:13px}
    /* Enter overlay */
    .enter{
      position:fixed; inset:0; display:grid; place-items:center; background:
        radial-gradient(60vw 60vw at 20% 10%, #ffe8f4 0 35%, transparent 35% 100%),
        radial-gradient(60vw 60vw at 80% 80%, #e8fff8 0 35%, transparent 35% 100%),
        linear-gradient(160deg,var(--bg),#fff);
      z-index:9999;
    }
    .enter .panel{
      width:min(560px,92vw); padding:26px; background:#fff; border:1px solid #f1eaff;
      border-radius:20px; box-shadow:var(--shadow); text-align:center
    }
    .enter h1{font-family:'Itim',cursive; margin:6px 0}
    .enter p{opacity:.8}
    /* Fireworks canvas */
    canvas#fx{position:fixed; inset:0; pointer-events:none; z-index:10}
    /* Confetti canvas */
    canvas#confetti{position:fixed; inset:0; pointer-events:none; z-index:9}
  </style>
</head>
<body>
  <div class="floaty" id="floaty"></div>
  <canvas id="confetti"></canvas>
  <canvas id="fx"></canvas>

  <!-- ENTER (autoplay-safe gate) -->
  <div class="enter" id="enter">
    <div class="panel">
      <div style="font-size:46px">üéÇüéà</div>
      <h1>‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏â‡∏•‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡πÑ‡∏´‡∏°?</h1>
      <p>‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏•‡∏á & ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå</p>
      <button class="btnAccent" id="startBtn">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡∏¢</button>
      <div class="note" style="margin-top:8px">*‡∏Å‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</div>
    </div>
  </div>

  <audio id="bgm" preload="auto" loop src="assets/hbd.mp3"></audio>

  <div class="wrap" aria-live="polite">
    <header>
      <div class="dot" style="background:var(--pink)"></div>
      <div class="dot" style="background:var(--lav)"></div>
      <div class="dot" style="background:var(--mint)"></div>
      <div class="title">Birthday Site</div>
      <div style="margin-left:auto; display:flex; gap:8px">
        <button class="btnGhost" id="btnToggleMusic">‚èØÔ∏è ‡πÄ‡∏û‡∏•‡∏á</button>
        <button class="btnGhost" id="btnShare">üîó ‡πÅ‡∏ä‡∏£‡πå</button>
      </div>
    </header>

    <main class="card">
      <section class="hero">
        <div class="glass heroL">
          <span class="tag">üéâ Happy Birthday</span>
          <h2 class="hbd">‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î <span id="name">‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏ô</span>!</h2>
          <div class="typed" id="typed"></div>

          <div class="meta">
            <span>üéÇ ‡∏≠‡∏≤‡∏¢‡∏∏ <b id="age">‚Äî</b></span>
            <span>üóìÔ∏è ‡πÄ‡∏Å‡∏¥‡∏î <b id="dobTxt">‚Äî</b></span>
            <span>‚è≥ ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏µ‡∏Å: ‡∏î‡∏π‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</span>
          </div>

          <div class="ctaRow">
            <button class="btnAccent" id="btnConfetti">‡πÇ‡∏õ‡∏£‡∏¢‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ü‡πá‡∏ï‡∏ï‡∏¥</button>
            <button class="btn" id="btnFireworks">‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡πÑ‡∏ü</button>
            <button class="btn" id="btnWish">‡∏™‡∏∏‡πà‡∏°‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£</button>
          </div>
        </div>
        <div class="glass heroR">
          <figure class="pola">
            <img id="cover" src="assets/cover.jpg" alt="‡∏£‡∏π‡∏õ‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î">
            <small>HBD ‚Ä¢ <span id="yearTag"></span></small>
          </figure>
        </div>
      </section>

      <section class="glass">
        <div class="countdown" id="countdown"></div>
      </section>

      <section class="glass slider" aria-label="‡πÅ‡∏Å‡∏•‡πÄ‡∏•‡∏≠‡∏£‡∏µ‡∏£‡∏π‡∏õ">
        <div class="slides" id="slides">
          <!-- ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì -->
          <img src="assets/p1.jpg" alt="‡∏†‡∏≤‡∏û‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥ 1">
          <img src="assets/p2.jpg" alt="‡∏†‡∏≤‡∏û‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥ 2">
          <img src="assets/p3.jpg" alt="‡∏†‡∏≤‡∏û‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥ 3">
        </div>
        <div class="dots" id="dots"></div>
      </section>

      <section class="wish">
        <h3 style="margin:0">üíå ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏ß‡∏¢‡∏û‡∏£</h3>
        <p id="wishText">‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏ï‡πá‡∏°‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏≠‡∏¢‡∏¢‡∏¥‡πâ‡∏° ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏≤‡∏∞ ‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡πà‡∏á‡∏î‡∏µ ‡πÜ ‡∏ô‡∏∞!</p>
        <div class="ctaRow">
          <button class="btnAccent" id="btnPrev">‚¨ÖÔ∏è ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
          <button class="btnAccent" id="btnNext">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚û°Ô∏è</button>
        </div>
        <p class="note">‡πÅ‡∏ï‡∏∞‡∏õ‡∏∏‡πà‡∏° ‚Äú‡∏™‡∏∏‡πà‡∏°‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£‚Äù ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏û‡∏£‡∏™‡πå‡πÄ‡∏û‡∏¥‡πà‡∏° ‚ú®</p>
      </section>
    </main>

    <footer>‡∏ó‡∏≥‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏±‡∏Å ‚Ä¢ ¬© <span id="footYear"></span></footer>
  </div>

<script>
/* ========= CUSTOMIZE ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ ========= */
const BDAY = {
  name: "‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏ô",                // ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
  dob: "2007-09-12",             // ‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö YYYY-MM-DD
  coverYearTag: new Date().getFullYear(),
  wishes: [
    "‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô/‡∏á‡∏≤‡∏ô‡∏õ‡∏±‡∏á ‡πÜ ‡∏ó‡∏∏‡∏Å‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå ‚ú®",
    "‡πÉ‡∏´‡πâ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡∏™‡∏¥‡πà‡∏á‡∏î‡∏µ ‡πÜ ‡∏ó‡∏±‡πâ‡∏á‡∏õ‡∏µ üéÅ",
    "‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡πÉ‡∏à‡∏™‡∏á‡∏ö ‡∏™‡∏î‡πÉ‡∏™ ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏û‡∏•‡∏±‡∏á‡∏ó‡∏≥‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å üíñ",
    "‡∏°‡∏µ‡∏Ñ‡∏ô‡∏£‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏à ‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏î‡∏µ ‡πÜ ‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏™‡∏°‡∏≠ ü§ç",
    "‡∏™‡∏°‡∏´‡∏ß‡∏±‡∏á‡πÉ‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏´‡∏ç‡πà ‡πÅ‡∏•‡∏∞‡∏î‡∏µ‡πÉ‡∏à‡πÑ‡∏õ‡∏Å‡∏±‡∏ö‡∏ä‡∏±‡∏¢‡∏ä‡∏ô‡∏∞‡πÄ‡∏•‡πá‡∏Å ‡πÜ ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô üèÜ"
  ],
  // ‡∏£‡∏π‡∏õ/‡πÄ‡∏û‡∏•‡∏á: ‡πÉ‡∏™‡πà‡πÑ‡∏ü‡∏•‡πå‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏≠‡∏á‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå assets/
  cover: "assets/cover.jpg",
  bgm: "assets/hbd.mp3",
  gallery: ["assets/p1.jpg","assets/p2.jpg","assets/p3.jpg"]
};
/* =================================== */

const $ = (q) => document.querySelector(q);
const $$ = (q) => document.querySelectorAll(q);

const state = { wishIdx: 0, slide:0, timer:null, musicOn:false };

/* Setup text */
$("#name").textContent = BDAY.name;
$("#yearTag").textContent = BDAY.coverYearTag;
$("#footYear").textContent = new Date().getFullYear();
$("#cover").src = BDAY.cover;

/* Age + DOB text */
const dob = new Date(BDAY.dob + "T00:00:00");
const today = new Date();
const ageYears = new Date(today - dob).getUTCFullYear() - 1970;
$("#age").textContent = ageYears;
$("#dobTxt").textContent = dob.toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric"});

/* Typed effect */
const lines = [
  `‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î ${BDAY.name} üéâ`,
  "‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏õ‡∏µ‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏î‡πÉ‡∏™‡πÅ‡∏•‡∏∞‡πÉ‡∏à‡πÄ‡∏ï‡πâ‡∏ô‡πÅ‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ù‡∏±‡∏ô üíó",
  "‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏°‡∏±‡πâ‡∏¢? ‡πÑ‡∏õ‡∏î‡∏π‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥‡∏î‡∏µ ‡πÜ ‡∏Å‡∏±‡∏ô‡πÄ‡∏•‡∏¢!"
];
const typedEl = $("#typed");
let li=0, ci=0;
function typeNext(){
  if(li>=lines.length) return;
  const line = lines[li];
  typedEl.textContent = line.slice(0, ci++);
  if(ci<=line.length){ requestAnimationFrame(()=>setTimeout(typeNext, 28)); }
  else { li++; ci=0; setTimeout(()=>{typedEl.textContent+="\n"; typeNext();}, 400); }
}

/* Countdown to next birthday */
const cdEl = $("#countdown");
function nextBirthday(from = new Date()){
  const n = new Date(from);
  const tgt = new Date(from);
  tgt.setMonth(dob.getMonth(), dob.getDate());
  tgt.setHours(0,0,0,0);
  if(tgt < n) tgt.setFullYear(n.getFullYear()+1);
  return tgt;
}
function renderCountdown(){
  const target = nextBirthday();
  const diff = target - new Date();
  const sec = Math.max(0, Math.floor(diff/1000));
  const d = Math.floor(sec/86400);
  const h = Math.floor((sec%86400)/3600);
  const m = Math.floor((sec%3600)/60);
  const s = sec%60;
  cdEl.innerHTML = ["‡∏ß‡∏±‡∏ô","‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á","‡∏ô‡∏≤‡∏ó‡∏µ","‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ"].map((label,i)=>{
    const val = [d,h,m,s][i];
    return `<div class="dd"><b>${String(val).padStart(2,"0")}</b><span>${label}</span></div>`;
  }).join("");
}
setInterval(renderCountdown, 1000); renderCountdown();

/* Gallery slider */
const slidesEl = $("#slides");
const dotsEl = $("#dots");
function buildSlides(){
  slidesEl.innerHTML = BDAY.gallery.map(src=>`<img src="${src}" alt="‡∏†‡∏≤‡∏û">`).join("");
  dotsEl.innerHTML = BDAY.gallery.map((_,i)=>`<button aria-label="‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà ${i+1}"></button>`).join("");
  updateSlide(0);
  $$("#dots button").forEach((b,i)=>b.onclick=()=>updateSlide(i));
}
function updateSlide(i){
  state.slide = (i+BDAY.gallery.length)%BDAY.gallery.length;
  slidesEl.style.transform = `translateX(${state.slide*-100}%)`;
  $$("#dots button").forEach((b,bi)=>b.classList.toggle("active", bi===state.slide));
}
let slideTimer = setInterval(()=>updateSlide(state.slide+1), 3500);

/* Wishes */
const wishEl = $("#wishText");
function showWish(idx){
  state.wishIdx = (idx+BDAY.wishes.length)%BDAY.wishes.length;
  wishEl.textContent = BDAY.wishes[state.wishIdx];
}
showWish(0);
$("#btnPrev").onclick = ()=>showWish(state.wishIdx-1);
$("#btnNext").onclick = ()=>showWish(state.wishIdx+1);
$("#btnWish").onclick = ()=>showWish(Math.floor(Math.random()*BDAY.wishes.length));

/* Music controls */
const audio = $("#bgm");
audio.src = BDAY.bgm;
function toggleMusic(force){
  if(typeof force === "boolean"){
    if(force && audio.paused){ audio.play(); state.musicOn=true; }
    else if(!force && !audio.paused){ audio.pause(); state.musicOn=false; }
  }else{
    if(audio.paused){ audio.play(); state.musicOn=true; }
    else { audio.pause(); state.musicOn=false; }
  }
}
$("#btnToggleMusic").onclick = ()=>toggleMusic();

/* Share */
$("#btnShare").onclick = async ()=>{
  const data = {title:"HBD üéÇ", text:`‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î ${BDAY.name}!`, url: location.href};
  if(navigator.share){ try{ await navigator.share(data); }catch(e){} }
  else{
    await navigator.clipboard.writeText(location.href);
    alert("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏•‡πâ‡∏ß!");
  }
}

/* Enter gate */
$("#startBtn").onclick = ()=>{
  $("#enter").style.display="none";
  toggleMusic(true);
  startConfettiBurst(120);
  setTimeout(typeNext, 200);
};

/* Floating balloons */
const floaty = $("#floaty");
function spawnBalloon(){
  const b = document.createElement("div");
  b.className="balloon";
  const colors = ["var(--pink)","var(--lav)","var(--mint)","var(--gold)"];
  b.style.background = colors[Math.floor(Math.random()*colors.length)];
  b.style.left = Math.random()*100 + "vw";
  b.style.setProperty("--drift", (Math.random()*60-30) + "vw");
  const dur = 12 + Math.random()*12;
  b.style.animationDuration = dur+"s";
  floaty.appendChild(b);
  setTimeout(()=>b.remove(), dur*1000);
}
setInterval(spawnBalloon, 900);
for(let i=0;i<8;i++) setTimeout(spawnBalloon, i*400);

/* Confetti (vanilla) */
const confettiCanvas = $("#confetti");
const cctx = confettiCanvas.getContext("2d");
function resizeCanvas(cv){ cv.width=innerWidth; cv.height=innerHeight; }
resizeCanvas(confettiCanvas); addEventListener("resize",()=>resizeCanvas(confettiCanvas));
let confettiParts=[];
function startConfettiBurst(n=80){
  for(let i=0;i<n;i++){
    confettiParts.push({
      x: Math.random()*confettiCanvas.width,
      y: -20,
      r: 6+Math.random()*8,
      a: Math.random()*Math.PI*2,
      s: 2+Math.random()*4,
      c: ["#ff6fb5","#a18aff","#84e1d8","#ffcc66"][i%4]
    });
  }
}
function drawConfetti(){
  cctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
  confettiParts.forEach(p=>{
    p.y += p.s; p.x += Math.sin(p.a+=0.05)*1.5;
    cctx.save(); cctx.fillStyle = p.c; cctx.translate(p.x,p.y); cctx.rotate(p.a);
    cctx.fillRect(-p.r/2,-p.r/2,p.r,p.r); cctx.restore();
  });
  confettiParts = confettiParts.filter(p=>p.y<confettiCanvas.height+40);
  requestAnimationFrame(drawConfetti);
}
drawConfetti();
$("#btnConfetti").onclick = ()=>startConfettiBurst(100);

/* Fireworks (simple) */
const fx = $("#fx"); const fctx = fx.getContext("2d"); resizeCanvas(fx);
function firework(){
  const cx = Math.random()*fx.width, cy = Math.random()*fx.height*0.6 + fx.height*0.2;
  const parts = []; const count = 60;
  for(let i=0;i<count;i++){
    const ang = (i/count)*Math.PI*2;
    parts.push({
      x:cx, y:cy, vx: Math.cos(ang)*(2+Math.random()*2), vy: Math.sin(ang)*(2+Math.random()*2),
      life: 40+Math.random()*20, color: ["#ff6fb5","#a18aff","#84e1d8","#ffcc66"][i%4]
    });
  }
  const anim = ()=> {
    fctx.globalCompositeOperation="lighter";
    fctx.fillStyle="rgba(0,0,0,0.05)"; fctx.fillRect(0,0,fx.width,fx.height); // fade trail
    parts.forEach(p=>{
      p.x+=p.vx; p.y+=p.vy; p.vy+=0.02; p.life--;
      fctx.beginPath(); fctx.arc(p.x,p.y,1.6,0,Math.PI*2);
      fctx.fillStyle=p.color; fctx.fill();
    });
    if(parts.some(p=>p.life>0)) requestAnimationFrame(anim);
  };
  anim();
}
$("#btnFireworks").onclick = ()=>{
  for(let i=0;i<3;i++) setTimeout(firework, i*300);
  startConfettiBurst(80);
};

/* Accessibility: pause animations when tab hidden */
document.addEventListener("visibilitychange", ()=>{ if(document.hidden) audio.pause(); else if(state.musicOn) audio.play(); });

/* Build gallery after DOM ready */
buildSlides();

/* Prevent long-press save on iOS (optional cute UX) */
document.addEventListener('contextmenu', e=>e.preventDefault());
</script>
</body>
</html>
